function dialogCallBack(n){console.log(n);n==1&&Invoke.openNetworkConnections()}var App={startApplication:function(){ConnectionStatus.check();bb.pushScreen("home.html","homeScr")},alert:function(n,t){blackberry.ui.dialog.standardAskAsync(n,blackberry.ui.dialog.D_OK,function(){},{title:t})},getValues:function(){var t=localStorage.getItem("lastDurakNo"),i,r,u,n;return t?(u=localStorage.getItem("lastHatNo"),n={durakNo:t,hatNo:u},this.values=n,n):(i="Lütfen bir durak numarası giriniz",r="Durak No",App.alert(i,r),null)},values:null,getBusInfo:function(){var t=App.getValues(),n;if(!t)return null;n=!1;$.each(bb.screens,function(t,i){i.id=="busInfoScr"&&(n=!0)});n==!1&&bb.pushScreen("busInfo.html","busInfoScr");Spinner.on();Connection.doAjaxReq(t)},showBusInfo:function(n){function l(n){var t="<li><h4>"+n.hatNo+", "+n.hatAd+"<\/h4><label>"+n.varisSure+"<\/label><br/><label>"+n.info+"<\/label><\/li>";t+="<hr/>";s=t}var s,f=[],h=document.getElementById("dataList"),e,u,c,o,t,i,r,a,v,y;if(this.values!=null&&this.values.hatNo!=""&&this.values.hatNo!=null)for(e=this.values.hatNo,u=0;u<n.length;u++)(c=n[u],e&&e!="undefined"&&c.hatNo!==e)||(l(c),f.push(s));else n.forEach(function(n){l(n);f.push(s)});if(Spinner.off(),o=new Date,t=o.getHours(),t<10&&(t="0"+t),i=o.getMinutes(),i<10&&(i="0"+i),r=o.getSeconds(),r<10&&(r="0"+r),a=t+":"+i+":"+r,$("#lblLastUpdateTime").html("Son güncellenme: "+a),$.isEmptyObject(n)||n.Row<1){v="Otobüs bulunamadı..";y="Sonuç";App.alert(v,y);return}try{h.innerHTML=f.join("");h.clear();h.refresh(f)}catch(p){}Timer.start()}},Application={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1);document.addEventListener("offline",ConnectionStatus.offline,!1);document.addEventListener("online",ConnectionStatus.online,!1)},onDeviceReady:function(){Application.receivedEvent("deviceready");bb.init({actionBarDark:!0,controlsDark:!0,listsDark:!1,onscreenready:function(){},ondomready:function(){$("#txtDurakNo").val(localStorage.getItem("lastDurakNo"));$("#txtHatNo").val(localStorage.getItem("lastHatNo"));$("#txtDurakNo").focus();$("#txtDurakNo").focusout(function(n){var t=$("#txtDurakNo").val();localStorage.setItem("lastDurakNo",t);n.keyCode==13&&App.getBusInfo()});$("#txtHatNo").focusout(function(n){var t=$("#txtHatNo").val();localStorage.setItem("lastHatNo",t);n.keyCode==13&&App.getBusInfo()})}});App.startApplication()},receivedEvent:function(n){console.log("Received Event: "+n)}},Connection={doAjaxReq:function(n){var t=n.hatNo||"",i=n.durakNo,r="http://www.ego.gov.tr/otobusnerede?durak_no="+i+"&hat_no="+t;$.ajax({url:r,success:Connection.returnData,error:function(n,t,i){console.warn("error: "+i);App.alert("Bağlantı esnasında hata oluştu. Lütfen tekrar deneyiniz.","Bağlantı hatası");ConnectionStatus.check()}})},returnData:function(n){var t="";try{if(n)t=Connection.parseHtml(n);else{console.log("correctedString: "+correctedString);throw"Data boş döndü!";}}catch(i){return console.warn(i),Spinner.off(),null}App.showBusInfo(t)},parseHtml:function(n){var r=[],t,i,f,e;if(!n)return r;var o=$.parseHTML(n),s=$(o).find(".otobusneredemobil"),h=$(s).find("tbody"),u=$(h).find("tr");for(t=0;t<u.length;t=t+3)i={hatNo:"",hatAd:"",varisSure:"",info:""},f=u[t],i.hatNo=$(f).find("th").text().trim(),i.hatAd=$(f).find("td").text().trim(),e=u[t+1],i.varisSure=$(e).find("h6:nth-child(2)").text().trim(),i.info=$(e).find("th h6:nth-child(3)").text().trim(),r.push(i);return r},myIp:"",loadMyIp:function(){$.getJSON("http://jsonip.com?callback=?",function(n){var t=n.ip;console.log(t);Connection.myIp=t})}},ConnectionStatus={offline:function(){try{blackberry.ui.dialog.customAskAsync("Devam edebilmek için Wi-Fi ya da mobil bir ağa bağlanın.",["Yoksay","Ayarlar"],dialogCallBack,{title:"Internet bağlantısı yok"});Timer.stop()}catch(n){alert(n);console.warn("Exception in standardDialog: "+n)}},online:function(){Connection.loadMyIp();App.getBusInfo()},check:function(){var n=blackberry.connection.type;console.log("con: "+n);n=="none"?(console.log("internet is offline"),this.offline()):(n==="wifi"||n==="4g"||n==="3g"||n==="2g"||n==="vpn")&&Connection.loadMyIp()}},Invoke={onInvokeError:function(n){console.warn("Invocation failed, error: "+n)},onInvokeSuccess:function(){},openNetworkConnections:function(){blackberry.invoke.invoke({target:"sys.settings.card",action:"bb.action.OPEN",type:"settings/view",uri:"settings://networkconnections"},this.onInvokeSuccess,this.onInvokeError)},maps:function(n){console.log(n);n!=null&&blackberry.invoke.invoke({action:"bb.action.OPEN",type:"application/vnd.rim.map.action-v1",data:JSON.stringify({placemark:{latitude:n.lat,longitude:n.lng}})})},appworldOpenMyVendorPage:function(){blackberry.invoke.invoke({target:"sys.appworld",action:"bb.action.OPEN",uri:"appworld://vendor/54824"},function(){console.log("success")},function(){console.log("error")})}},Spinner={visible:!1,off:function(){$("#spinner").hide();Spinner.visible=!1},on:function(){$("#spinner").show();Spinner.visible=!0}},Timer={working:!1,counter:null,start:function(){this.working=!0;this.stop();this.counter=setInterval(App.getBusInfo,3e4)},stop:function(){clearInterval(this.counter);this.working=!1}};
//# sourceMappingURL=app.complete.bundle.min.js.map
